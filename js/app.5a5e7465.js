(function(e){function t(t){for(var n,o,l=t[0],s=t[1],c=t[2],d=0,f=[];d<l.length;d++)o=l[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&f.push(r[o][0]),r[o]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);u&&u(t);while(f.length)f.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,l=1;l<a.length;l++){var s=a[l];0!==r[s]&&(n=!1)}n&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},r={app:0},i=[];function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=s;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},1:function(e,t){},"106f":function(e,t,a){},"10ea":function(e,t,a){},"1f4e":function(e,t,a){"use strict";var n=a("8013"),r=a.n(n);r.a},2:function(e,t){},"26ab":function(e,t,a){e.exports=a.p+"img/planet.e4ede5d4.jpg"},3:function(e,t){},"33ae":function(e,t,a){e.exports=a.p+"img/city.01b6dced.jpg"},"3f25":function(e,t,a){"use strict";var n=a("106f"),r=a.n(n);r.a},"46a5":function(e,t,a){"use strict";var n=a("a632"),r=a.n(n);r.a},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-content",[a("MediaEditor")],1)],1)},i=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("VContainer",{attrs:{fluid:"","fill-height":"","align-stretch":"","pa-0":""}},[a("VRow",{staticClass:"fill-height",attrs:{"no-gutters":""}},[a("VCol",{attrs:{cols:"5",md:"4",lg:"3"}},[a("InputPanel",{attrs:{layers:e.layers,"font-family-names":e.fontFamilyNames,filter:e.selectedFilter,filters:e.filters,"selected-layer":e.selectedLayer,"filter-preview-image":e.filterPreviewImage,"disable-filter-tab":e.disableFiltersTab},on:{"update:layers":function(t){e.layers=t},"update:filter":function(t){e.selectedFilter=t},"add-image-layer":e.onFileSelected,"add-text-layer":function(t){return e.addTextLayer("")},"bg-image-file-selected":e.onBackgroundImageFileSelected,"bg-image-url-selected":e.onBackgroundImageUrlSelected,"clear-bg":function(t){e.backgroundImage=null},"remove-layer":e.removeLayer,"enter-filters":e.onEnterFilters,"leave-filters":e.onLeaveFilters}})],1),a("VCol",{staticClass:"fill-height",attrs:{cols:"7",md:"8",lg:"9"}},[a("WorkingArea",{ref:"working_area",staticClass:"fill-height",attrs:{layers:e.renderLayers,formats:e.formats,"selected-format":e.selectedFormat,"background-image":e.backgroundImage,filter:e.selectedFilter,"disable-formats-toggling":e.disableFormatSelection,"filter-source-images":e.savedImages,"is-filter-mode":e.isFilterMode},on:{"layer-selected":e.onLayerSelected,"layer-deselected":e.onLayerDeselected,"format-selected":e.onFormatSelected,"format-deselected":e.onFormatDeselected,"filter-applying":e.onApplyingFilter,"filter-applied":e.onAppliedFilter,"saving-all":e.onSavingAll,"saved-all":e.onSavedAll,"error-saving-all":e.onErrorSavingAll,"fabric-images-saving":e.onFabricImagesSaving,"fabric-images-saved":e.onFabricImagesSaved,"fabric-images-saving-error":e.onFabricImagesSavingError}})],1)],1),a("VOverlay",{attrs:{value:e.showLoading}},[a("VProgressCircular",{attrs:{indeterminate:null===e.loadProgress,value:e.loadProgressPercentage,size:60}},[e._v(" "+e._s(e.loadProgressPercentage)+" ")])],1)],1)},l=[],s=(a("4de4"),a("4160"),a("c975"),a("d81d"),a("a434"),a("b680"),a("b64b"),a("d3b7"),a("ac1f"),a("1276"),a("159b"),a("5530")),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"relative-wrapper blue-grey lighten-3"},[a("div",{staticClass:"absolute-wrapper"},[a("VTabs",{attrs:{"background-color":"blue-grey",dark:"",height:"64"},model:{value:e.tabs,callback:function(t){e.tabs=t},expression:"tabs"}},[a("VTab",[a("VIcon",[e._v("mdi-image")]),e._v(" Фон ")],1),a("VTab",[a("VIcon",[e._v("mdi-layers")]),e._v(" Элементы ")],1),a("VTab",{attrs:{disabled:e.disableFilterTab}},[a("VIcon",[e._v("mdi-image-filter-vintage")]),e._v(" Фильтр ")],1)],1),a("VTabsItems",{staticClass:"blue-grey lighten-3",model:{value:e.tabs,callback:function(t){e.tabs=t},expression:"tabs"}},[a("VTabItem",[a("BackgroundProperties",{attrs:{"enable-drop-zone":0===e.tabs},on:{"file-selected":function(t){return e.$emit("bg-image-file-selected",t)},"url-selected":function(t){return e.$emit("bg-image-url-selected",t)},"clear-background":function(t){return e.$emit("clear-bg")}}})],1),a("VTabItem",[a("VExpandTransition",[e.selectedLayer?["text"===e.selectedLayer.type?a("TextLayer",{attrs:{text:e.selectedLayer.text,"font-size":e.selectedLayer.fontSize,color:e.selectedLayer.color,"char-spacing":e.selectedLayer.charSpacing,"font-family":e.selectedLayer.fontFamily,"font-weight":e.selectedLayer.fontWeight,"font-style":e.selectedLayer.fontStyle,underline:e.selectedLayer.underline,linethrough:e.selectedLayer.linethrough,overline:e.selectedLayer.overline,"text-align":e.selectedLayer.textAlign,"line-height":e.selectedLayer.lineHeight,"shadow-color":e.selectedLayer.shadowColor,"shadow-x-offset":e.selectedLayer.shadowXOffset,"shadow-y-offset":e.selectedLayer.shadowYOffset,"shadow-blur":e.selectedLayer.shadowBlur,"stroke-color":e.selectedLayer.stroke,"stroke-width":e.selectedLayer.strokeWidth,opacity:e.selectedLayer.opacity,"background-color":e.selectedLayer.textBackgroundColor,name:e.selectedLayer.name,"font-family-names":e.fontFamilyNames},on:{"update:text":function(t){return e.$set(e.selectedLayer,"text",t)},"update:fontSize":function(t){return e.$set(e.selectedLayer,"fontSize",t)},"update:font-size":function(t){return e.$set(e.selectedLayer,"fontSize",t)},"update:color":function(t){return e.$set(e.selectedLayer,"color",t)},"update:charSpacing":function(t){return e.$set(e.selectedLayer,"charSpacing",t)},"update:char-spacing":function(t){return e.$set(e.selectedLayer,"charSpacing",t)},"update:fontFamily":function(t){return e.$set(e.selectedLayer,"fontFamily",t)},"update:font-family":function(t){return e.$set(e.selectedLayer,"fontFamily",t)},"update:fontWeight":function(t){return e.$set(e.selectedLayer,"fontWeight",t)},"update:font-weight":function(t){return e.$set(e.selectedLayer,"fontWeight",t)},"update:fontStyle":function(t){return e.$set(e.selectedLayer,"fontStyle",t)},"update:font-style":function(t){return e.$set(e.selectedLayer,"fontStyle",t)},"update:underline":function(t){return e.$set(e.selectedLayer,"underline",t)},"update:linethrough":function(t){return e.$set(e.selectedLayer,"linethrough",t)},"update:overline":function(t){return e.$set(e.selectedLayer,"overline",t)},"update:textAlign":function(t){return e.$set(e.selectedLayer,"textAlign",t)},"update:text-align":function(t){return e.$set(e.selectedLayer,"textAlign",t)},"update:lineHeight":function(t){return e.$set(e.selectedLayer,"lineHeight",t)},"update:line-height":function(t){return e.$set(e.selectedLayer,"lineHeight",t)},"update:shadowColor":function(t){return e.$set(e.selectedLayer,"shadowColor",t)},"update:shadow-color":function(t){return e.$set(e.selectedLayer,"shadowColor",t)},"update:shadowXOffset":function(t){return e.$set(e.selectedLayer,"shadowXOffset",t)},"update:shadow-x-offset":function(t){return e.$set(e.selectedLayer,"shadowXOffset",t)},"update:shadowYOffset":function(t){return e.$set(e.selectedLayer,"shadowYOffset",t)},"update:shadow-y-offset":function(t){return e.$set(e.selectedLayer,"shadowYOffset",t)},"update:shadowBlur":function(t){return e.$set(e.selectedLayer,"shadowBlur",t)},"update:shadow-blur":function(t){return e.$set(e.selectedLayer,"shadowBlur",t)},"update:strokeColor":function(t){return e.$set(e.selectedLayer,"stroke",t)},"update:stroke-color":function(t){return e.$set(e.selectedLayer,"stroke",t)},"update:strokeWidth":function(t){return e.$set(e.selectedLayer,"strokeWidth",t)},"update:stroke-width":function(t){return e.$set(e.selectedLayer,"strokeWidth",t)},"update:opacity":function(t){return e.$set(e.selectedLayer,"opacity",t)},"update:backgroundColor":function(t){return e.$set(e.selectedLayer,"textBackgroundColor",t)},"update:background-color":function(t){return e.$set(e.selectedLayer,"textBackgroundColor",t)},"update:name":function(t){return e.$set(e.selectedLayer,"name",t)},delete:function(t){return e.removeLayer(e.selectedLayer)}}}):"image"===e.selectedLayer.type?a("ImageLayer",{attrs:{image:e.selectedLayer.image,name:e.selectedLayer.name,opacity:e.selectedLayer.opacity,"shadow-color":e.selectedLayer.shadowColor,"shadow-x-offset":e.selectedLayer.shadowXOffset,"shadow-y-offset":e.selectedLayer.shadowYOffset,"shadow-blur":e.selectedLayer.shadowBlur,"stroke-color":e.selectedLayer.stroke,"stroke-width":e.selectedLayer.strokeWidth},on:{"update:name":function(t){return e.$set(e.selectedLayer,"name",t)},"update:opacity":function(t){return e.$set(e.selectedLayer,"opacity",t)},"update:shadowColor":function(t){return e.$set(e.selectedLayer,"shadowColor",t)},"update:shadow-color":function(t){return e.$set(e.selectedLayer,"shadowColor",t)},"update:shadowXOffset":function(t){return e.$set(e.selectedLayer,"shadowXOffset",t)},"update:shadow-x-offset":function(t){return e.$set(e.selectedLayer,"shadowXOffset",t)},"update:shadowYOffset":function(t){return e.$set(e.selectedLayer,"shadowYOffset",t)},"update:shadow-y-offset":function(t){return e.$set(e.selectedLayer,"shadowYOffset",t)},"update:shadowBlur":function(t){return e.$set(e.selectedLayer,"shadowBlur",t)},"update:shadow-blur":function(t){return e.$set(e.selectedLayer,"shadowBlur",t)},"update:strokeColor":function(t){return e.$set(e.selectedLayer,"stroke",t)},"update:stroke-color":function(t){return e.$set(e.selectedLayer,"stroke",t)},"update:strokeWidth":function(t){return e.$set(e.selectedLayer,"strokeWidth",t)},"update:stroke-width":function(t){return e.$set(e.selectedLayer,"strokeWidth",t)},delete:function(t){return e.removeLayer(e.selectedLayer)}}}):e._e()]:e._e()],2),a("div",{staticClass:"pa-1"},[a("VRow",{attrs:{dense:""}},[a("VCol",{attrs:{cols:"6"}},[a("VCard",[a("FileSelectionArea",{attrs:{"enable-drop-zone":1===e.tabs},on:{input:function(t){return e.$emit("add-image-layer",t)}}},[[a("VResponsive",{staticClass:"d-flex align-center justify-center blue-grey lighten-1",attrs:{"aspect-ratio":1}},[a("div",{staticClass:"text-center white--text"},[a("VIcon",{attrs:{size:"48",color:"white"}},[e._v("mdi-image")]),a("br"),e._v(" Изображение ")],1)])]],2)],1)],1),a("VCol",{attrs:{cols:"6"}},[a("VCard",{on:{click:function(t){return e.$emit("add-text-layer")}}},[a("VResponsive",{staticClass:"d-flex align-center justify-center blue-grey lighten-1",attrs:{"aspect-ratio":1}},[a("div",{staticClass:"text-center white--text"},[a("VIcon",{attrs:{size:"48",color:"white"}},[e._v("mdi-format-text")]),a("br"),e._v(" Текст ")],1)])],1)],1)],1)],1)],1),a("VTabItem",[a("FilterProperties",{attrs:{filters:e.filters,"selected-filter":e.filter,"filter-preview-image":e.filterPreviewImage},on:{selected:function(t){return e.$emit("update:filter",t)}}})],1)],1)],1)])},u=[],d=(a("fb6a"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"file-selection-area"},[a("label",{staticClass:"file-selection-area__label",attrs:{for:e.id}},[a("input",{ref:"input",staticClass:"file-selection-area__file-input",attrs:{type:"file",id:e.id,accept:"image/jpeg,image/png,image/gif",multiple:e.multiple,disabled:e.disabled},on:{change:e.onFileInputChange}}),e._t("default",null,{click:e.openFileDialog})],2),a("div",{directives:[{name:"show",rawName:"v-show",value:e.displayDropZone,expression:"displayDropZone"}],staticClass:"file-selection-area__drop-zone",on:{dragenter:function(t){return t.preventDefault(),e.onDropZoneDragenter(t)},dragover:function(t){return t.preventDefault(),e.onDropZoneDragover(t)},drop:function(t){return t.preventDefault(),t.stopPropagation(),e.onDrop(t)},dragleave:function(t){return t.preventDefault(),e.onDropzoneDragleave(t)}}},[a("div",{ref:"drop_zone",staticClass:"file-selection-area__drop-zone-inner"},[e._t("drop-zone")],2)])])}),f=[];function h(e){if(!("items"in e.dataTransfer))return!0;for(var t,a=0;t=e.dataTransfer.items[a];a++)if("file"===t.kind.toLowerCase())return!0;return!1}var m={name:"FileSelectionArea",props:{id:String,multiple:Boolean,disabled:Boolean,enableDropZone:{type:Boolean,default:!1}},data:function(){return{files:[],displayDropZone:!1,dragenterCounter:0}},mounted:function(){var e=this;this.onDocDragEnter=function(t){!e.disabled&&e.enableDropZone&&h(t)&&e.showDropZone()},document.addEventListener("dragenter",this.onDocDragEnter)},beforeDestroy:function(){document.removeEventListener("dragenter",this.onDocDragEnter)},methods:{openFileDialog:function(){this.$refs.input.click()},onFileInputChange:function(e){this.handleFileSelection(e.target.files),this.$refs.input.value=""},handleFileSelection:function(e){this.disabled||(e?(this.files=Array.prototype.filter.call(e,(function(e){return/image\/jpe?g|png/.test(e.type)})),this.files.length||(this.files=null)):this.files=null,this.$emit("input",this.files))},onDropZoneDragover:function(e){e.preventDefault()},onDropZoneDragenter:function(e){this.dragenterCounter++},onDropzoneDragleave:function(e){this.dragenterCounter--,this.dragenterCounter||this.hideDropZone()},onDrop:function(e){this.hideDropZone(),this.dragenterCounter=0,this.handleFileSelection(e.dataTransfer.files)},showDropZone:function(){this.displayDropZone=!0},hideDropZone:function(){this.displayDropZone=!1}}},p=m,g=(a("c99c"),a("2877")),v=Object(g["a"])(p,d,f,!1,null,"0b99be00",null),y=v.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("VCard",{staticClass:"pa-1 ma-1"},[a("VCardTitle",[a("span",[e._v("Свойства текста")]),a("VSpacer"),a("VBtn",{attrs:{icon:"",color:"red",dark:""},on:{click:function(t){return e.$emit("delete")}}},[a("VIcon",[e._v("mdi-delete-forever")])],1)],1),a("VCardText",[a("VTextarea",{attrs:{label:"Текст",rows:"2"},model:{value:e.localText,callback:function(t){e.localText=t},expression:"localText"}}),a("VRow",{attrs:{dense:""}},[a("VCol",{attrs:{cols:"9"}},[a("VSelect",{attrs:{label:"Шрифт",items:e.fonts},scopedSlots:e._u([{key:"item",fn:function(t){var n=t.item;return[a("span",{style:{fontFamily:n.value}},[e._v(" "+e._s(n.text)+" ")])]}}]),model:{value:e.localFontFamily,callback:function(t){e.localFontFamily=t},expression:"localFontFamily"}})],1),a("VCol",{attrs:{cols:"3"}},[a("VTextField",{attrs:{label:"Размер",type:"number",min:"1",max:"500",step:"1"},model:{value:e.localFontSize,callback:function(t){e.localFontSize=e._n(t)},expression:"localFontSize"}})],1)],1),a("VBtnToggle",{staticClass:"mr-1 mb-2",attrs:{multiple:""},model:{value:e.format,callback:function(t){e.format=t},expression:"format"}},[a("VTooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("VBtn",e._g({},n),[a("VIcon",[e._v("mdi-format-bold")])],1)]}}])},[e._v(" Полужирный ")]),a("VTooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("VBtn",e._g({},n),[a("VIcon",[e._v("mdi-format-italic")])],1)]}}])},[e._v(" Курсив ")]),a("VTooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("VBtn",e._g({},n),[a("VIcon",[e._v("mdi-format-underline")])],1)]}}])},[e._v(" Подчеркнутый ")]),a("VTooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("VBtn",e._g({},n),[a("VIcon",[e._v("mdi-format-strikethrough")])],1)]}}])},[e._v(" Зачеркнутый ")]),a("VTooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("VBtn",e._g({},n),[a("VIcon",[e._v("mdi-format-overline")])],1)]}}])},[e._v(" Надчеркнутый ")])],1),a("VBtnToggle",{staticClass:"mr-1 mb-2",attrs:{multiple:""},model:{value:e.formatColors,callback:function(t){e.formatColors=t},expression:"formatColors"}},[a("ColorButton",{attrs:{icon:"mdi-format-color-text",tooltip:"Цвет текста"},model:{value:e.localColor,callback:function(t){e.localColor=t},expression:"localColor"}}),a("ColorButton",{attrs:{icon:"mdi-format-color-fill",tooltip:"Цвет фона"},scopedSlots:e._u([{key:"actions",fn:function(t){return[a("VBtn",{attrs:{small:""},on:{click:function(a){return e.turnOffBgColor(t)}}},[e._v(" Без заливки ")])]}}]),model:{value:e.localBackgroundColor,callback:function(t){e.localBackgroundColor=t},expression:"localBackgroundColor"}})],1),a("VExpandTransition",[e.isMultiline?a("VBtnToggle",{staticClass:"mb-2",model:{value:e.alignment,callback:function(t){e.alignment=t},expression:"alignment"}},[a("VBtn",[a("VIcon",[e._v("mdi-format-align-left")])],1),a("VBtn",[a("VIcon",[e._v("mdi-format-align-center")])],1),a("VBtn",[a("VIcon",[e._v("mdi-format-align-right")])],1)],1):e._e()],1),a("VSlider",{attrs:{label:"Непрозрачность",min:"0",max:"1",step:"0.1"},model:{value:e.localOpacity,callback:function(t){e.localOpacity=t},expression:"localOpacity"}}),a("VSlider",{attrs:{label:"Рассотяние",min:"0",max:"1000"},model:{value:e.localCharSpacing,callback:function(t){e.localCharSpacing=e._n(t)},expression:"localCharSpacing"}}),a("VExpandTransition",[e.isMultiline?a("VSlider",{attrs:{label:"Интервал",min:"0.1",max:"10",step:.1},model:{value:e.localLineHeight,callback:function(t){e.localLineHeight=t},expression:"localLineHeight"}}):e._e()],1),a("VCheckbox",{attrs:{label:"Тень"},model:{value:e.shadow,callback:function(t){e.shadow=t},expression:"shadow"}}),a("VExpandTransition",[e.shadow?a("VRow",{attrs:{dense:""}},[a("VCol",{attrs:{cols:"4"}},[a("div",{staticClass:"mt-2"},[a("ColorInput",{attrs:{label:"Цвет"},model:{value:e.localShadowColor,callback:function(t){e.localShadowColor=t},expression:"localShadowColor"}})],1)]),a("VCol",{attrs:{cols:"4"}},[a("VTextField",{attrs:{label:"По горизонтали",type:"number",min:"-1000",max:"1000",step:"1"},model:{value:e.localShadowXOffset,callback:function(t){e.localShadowXOffset=e._n(t)},expression:"localShadowXOffset"}})],1),a("VCol",{attrs:{cols:"4"}},[a("VTextField",{attrs:{label:"По вертикали",type:"number",min:"-1000",max:"1000",step:"1"},model:{value:e.localShadowYOffset,callback:function(t){e.localShadowYOffset=e._n(t)},expression:"localShadowYOffset"}})],1),a("VDivider"),a("VSlider",{attrs:{label:"Размытие",min:"0",max:"100",step:"1"},model:{value:e.localShadowBlur,callback:function(t){e.localShadowBlur=t},expression:"localShadowBlur"}})],1):e._e()],1),a("VCheckbox",{attrs:{label:"Обводка"},model:{value:e.stroke,callback:function(t){e.stroke=t},expression:"stroke"}}),a("VExpandTransition",[e.stroke?a("div",[a("ColorInput",{attrs:{label:"Цвет"},model:{value:e.localStrokeColor,callback:function(t){e.localStrokeColor=t},expression:"localStrokeColor"}}),a("VSlider",{attrs:{label:"Толщина",min:"0.5",max:"30",step:"0.5"},model:{value:e.localStrokeWidth,callback:function(t){e.localStrokeWidth=t},expression:"localStrokeWidth"}})],1):e._e()])],1)],1)},w=[],C=(a("99af"),a("b0c0"),a("a9e3"),a("2ef0"));function k(e){return new Promise((function(t,a){var n=new Image;n.onload=function(){n.onload=null,n.onerror=null,t(n)},n.onerror=function(){n.onload=null,n.onerror=null,a(new Error("Couldn't load image"))},n.src=e}))}function x(e,t){return new Promise((function(a,n){var r=new FileReader;r.onloadend=function(){return a(r.result)},r.onerror=function(){return n(r.error)},t&&(r.onprogress=function(e){t(e.loaded/e.total)}),r.readAsDataURL(e)}))}function V(e){return function(t,a){t!==a&&t!==this[e]&&(this[e]=t)}}function S(e){return function(t,a){t!==a&&t!==this[e]&&this.$emit("update:"+Object(C["kebabCase"])(e),t)}}function F(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={};return e.forEach((function(e){var r="local"+Object(C["upperFirst"])(e);n[e]={handler:V(r),immediate:t},n[r]={handler:S(e),immediate:a}})),n}var _=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("VMenu",{ref:"menu",attrs:{"close-on-content-click":!1,"close-on-click":!0,"return-value":e.color,transition:"scale-transition","offset-y":"","min-width":"290px",disabled:e.disabled},on:{"update:returnValue":function(t){e.color=t},"update:return-value":function(t){e.color=t}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("VInput",{attrs:{label:e.label}},[a("div",e._g({staticClass:"transparent-backdrop"},n),[a("div",{staticClass:"color-sample",class:{disabled:!!e.disabled},style:{backgroundColor:e.sheetColor}})])])]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[a("VCard",[a("VColorPicker",{attrs:{"hide-mode-switch":!0,mode:"rgba"},model:{value:e.color,callback:function(t){e.color=t},expression:"color"}}),a("VCardActions",[a("VBtn",{attrs:{small:"",color:"primary"},on:{click:function(t){return e.$refs.menu.save(e.color)}}},[e._v(" Ok ")]),a("VBtn",{attrs:{small:""},on:{click:function(t){e.menu=!1}}},[e._v(" Отмена ")])],1)],1)],1)},O=[],$={name:"ColorInput",props:{value:{type:String,default:"#000"},label:String,disabled:Boolean},data:function(){return{menu:!1,color:this.value}},computed:{sheetColor:function(){return this.color}},watch:{value:{handler:function(e,t){e!==t&&(this.color=e)},immediate:!0},color:function(e,t){e!==t&&this.$emit("input",e)}}},L=$,I=(a("3f25"),a("6544")),B=a.n(I),T=a("8336"),A=a("b0af"),z=a("99d9"),j=a("03a4"),D=a("b675"),P=a("e449"),E=Object(g["a"])(L,_,O,!1,null,"42f18846",null),W=E.exports;B()(E,{VBtn:T["a"],VCard:A["a"],VCardActions:z["a"],VColorPicker:j["a"],VInput:D["a"],VMenu:P["a"]});var N={props:{shadowColor:{type:[String,null],default:null},shadowXOffset:Number,shadowYOffset:Number,shadowBlur:Number},data:function(){return{shadow:!1,localShadowColor:"#000",localShadowXOffset:null,localShadowYOffset:null,localShadowBlur:null}},watch:Object(s["a"])({},F(["shadowXOffset","shadowYOffset","shadowBlur"]),{shadowColor:{handler:function(e){e?(e!==this.localShadowColor&&(this.localShadowColor=e),this.shadow=!0):!e&&this.shadow&&(this.shadow=!1)},immediate:!0},localShadowColor:function(e){e&&e!==this.shadowColor&&this.shadow&&this.$emit("update:shadow-color",e)},shadow:function(e){!e&&this.shadowColor?this.$emit("update:shadow-color",null):!e||this.shadowColor&&this.shadowColor===this.localShadowColor||this.$emit("update:shadow-color",this.localShadowColor)}})},X={props:{strokeColor:{type:String,default:"#000"},strokeWidth:Number},data:function(){return{stroke:!1,localStrokeColor:null,localStrokeWidth:null}},watch:Object(s["a"])({},F(["strokeColor"]),{strokeWidth:{handler:function(e){e!==this.localStrokeWidth&&(this.localStrokeWidth=e),this.stroke=!!e},immediate:!0},localStrokeWidth:function(e){this.stroke||(e=0),e!==this.strokeWidth&&this.$emit("update:stroke-width",e)},stroke:function(e){!e&&this.strokeWidth?this.$emit("update:stroke-width",0):e&&this.strokeWidth!==this.localStrokeWidth&&this.$emit("update:stroke-width",this.localStrokeWidth)}})},Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("VMenu",{ref:"menu",attrs:{"close-on-content-click":!1,"close-on-click":!0,"return-value":e.color,transition:"scale-transition","offset-y":"","min-width":"290px",disabled:e.disabled},on:{"update:returnValue":function(t){e.color=t},"update:return-value":function(t){e.color=t}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("VTooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[a("VBtn",e._g({},Object.assign({},n,r)),[a("VRow",{staticClass:"flex-column",attrs:{align:"center",justify:"center"}},[a("VIcon",{staticClass:"cols 12"},[e._v(e._s(e.icon))]),a("VSheet",{staticStyle:{"margin-top":"-4px"},attrs:{tile:"",height:"4",width:"26",color:e.color}})],1)],1)]}}],null,!0)},[e._v(" "+e._s(e.tooltip)+" ")])]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[a("VCard",[a("VColorPicker",{attrs:{"hide-mode-switch":!0,mode:"rgba"},model:{value:e.color,callback:function(t){e.color=t},expression:"color"}}),a("VCardActions",[a("VBtn",{attrs:{small:"",color:"primary"},on:{click:function(t){return e.$refs.menu.save(e.color)}}},[e._v(" Ok ")]),a("VBtn",{attrs:{small:""},on:{click:function(t){e.menu=!1}}},[e._v(" Отмена ")]),e._t("actions",null,{closeMenu:e.closeMenu})],2)],1)],1)},M=[],R={name:"color-button",props:{value:{type:String,default:"#000"},label:String,icon:String,disabled:Boolean,tooltip:String},data:function(){return{menu:!1,color:this.value}},computed:{sheetColor:function(){return this.color}},watch:{value:{handler:function(e,t){e!==t&&(this.color=e)},immediate:!0},color:function(e,t){e!==t&&this.$emit("input",e)}},methods:{closeMenu:function(){this.menu=!1}}},H=R,Z=a("132d"),U=a("0fd9"),G=a("8dd9"),q=a("3a2f"),J=Object(g["a"])(H,Y,M,!1,null,null,null),K=J.exports;B()(J,{VBtn:T["a"],VCard:A["a"],VCardActions:z["a"],VColorPicker:j["a"],VIcon:Z["a"],VMenu:P["a"],VRow:U["a"],VSheet:G["a"],VTooltip:q["a"]});var Q={name:"text-layer",mixins:[N,X],components:{ColorInput:W,ColorButton:K},props:{name:String,text:String,fontSize:Number,color:String,charSpacing:Number,fontFamily:String,fontWeight:String,fontStyle:String,underline:Boolean,linethrough:Boolean,overline:Boolean,textAlign:String,lineHeight:Number,opacity:Number,backgroundColor:{type:[String,null],default:null},fontFamilyNames:Array},data:function(){return{format:[],formatColors:[],alignment:0,localText:"",localFontSize:null,localColor:null,localCharSpacing:null,localFontFamily:null,localLineHeight:null,localOpacity:null,localBackgroundColor:"#fff"}},computed:{fonts:function(){return[{value:"serif",text:"Serif"},{value:"sans-serif",text:"Sans-Serif"}].concat(this.fontFamilyNames.map((function(e){return{value:e,text:e}})))},isMultiline:function(){return/\n/.test(this.localText)},formatDense:function(){switch(this.$vuetify.breakpoint.name){case"xs":return!0;case"sm":return!0;case"md":return!0;case"lg":return!1;case"xl":return!1}}},watch:Object(s["a"])({},F(["text","fontSize","color","charSpacing","fontFamily","lineHeight","opacity"]),{backgroundColor:{handler:function(e){e?(e!==this.localBackgroundColor&&(this.localBackgroundColor=e),-1===this.formatColors.indexOf(1)&&this.formatColors.push(1)):-1!==this.formatColors.indexOf(1)&&this.formatColors.splice(this.formatColors.indexOf(1),1)},immediate:!0},localBackgroundColor:function(e){!e||this.backgroundColor&&this.backgroundColor===e?!e&&this.backgroundColor&&this.$emit("update:background-color",null):this.$emit("update:background-color",e)},fontWeight:{handler:function(e,t){e!==t&&("bold"===e&&-1===this.format.indexOf(0)?this.format.push(0):"bold"!==e&&-1!==this.format.indexOf(0)&&this.format.splice(this.format.indexOf(0),1))},immediate:!0},fontStyle:{handler:function(e,t){e!==t&&("italic"===e&&-1===this.format.indexOf(1)?this.format.push(1):"italic"!==e&&-1!==this.format.indexOf(1)&&this.format.splice(this.format.indexOf(1),1))},immediate:!0},underline:{handler:function(e){e&&-1===this.format.indexOf(2)?this.format.push(2):e||-1===this.format.indexOf(2)||this.format.splice(this.format.indexOf(2),1)},immediate:!0},linethrough:{handler:function(e){e&&-1===this.format.indexOf(3)?this.format.push(3):e||-1===this.format.indexOf(3)||this.format.splice(this.format.indexOf(3),1)},immediate:!0},overline:{handler:function(e){e&&-1===this.format.indexOf(4)?this.format.push(4):e||-1===this.format.indexOf(4)||this.format.splice(this.format.indexOf(4),1)},immediate:!0},format:function(e){-1!==e.indexOf(0)&&"bold"!==this.fontWeight?this.$emit("update:font-weight","bold"):-1===e.indexOf(0)&&"normal"!==this.fontWeight&&this.$emit("update:font-weight","normal"),-1!==e.indexOf(1)&&"italic"!==this.fontStyle?this.$emit("update:font-style","italic"):-1===e.indexOf(1)&&"normal"!==this.fontStyle&&this.$emit("update:font-style","normal"),-1===e.indexOf(2)||this.underline?-1===e.indexOf(2)&&this.underline&&this.$emit("update:underline",!1):this.$emit("update:underline",!0),-1===e.indexOf(3)||this.linethrough?-1===e.indexOf(3)&&this.linethrough&&this.$emit("update:linethrough",!1):this.$emit("update:linethrough",!0),-1===e.indexOf(4)||this.overline?-1===e.indexOf(4)&&this.overline&&this.$emit("update:overline",!1):this.$emit("update:overline",!0)},formatColors:function(e){-1!==e.indexOf(0)&&this.formatColors.splice(this.formatColors.indexOf(0),1),-1!==e.indexOf(1)?null===this.backgroundColor&&this.formatColors.splice(this.formatColors.indexOf(1),1):null!==this.backgroundColor&&this.formatColors.push(1)},textAlign:{handler:function(e){var t=0;switch(e){case"left":t=0;break;case"center":t=1;break;case"right":t=2;break}t!==this.alignment&&(this.alignment=t)},immediate:!0},alignment:function(e){var t=["left","center","right"],a=t[e];a!==this.textAlign&&this.$emit("update:text-align",a)}}),methods:{turnOffBgColor:function(e){e.closeMenu(),this.$emit("update:background-color",null)}}},ee=Q,te=a("a609"),ae=a("ac7c"),ne=a("62ad"),re=a("ce7e"),ie=a("0789"),oe=a("b974"),le=a("ba0d"),se=a("2fa4"),ce=a("8654"),ue=a("a844"),de=Object(g["a"])(ee,b,w,!1,null,null,null),fe=de.exports;B()(de,{VBtn:T["a"],VBtnToggle:te["a"],VCard:A["a"],VCardText:z["b"],VCardTitle:z["c"],VCheckbox:ae["a"],VCol:ne["a"],VDivider:re["a"],VExpandTransition:ie["a"],VIcon:Z["a"],VRow:U["a"],VSelect:oe["a"],VSlider:le["a"],VSpacer:se["a"],VTextField:ce["a"],VTextarea:ue["a"],VTooltip:q["a"]});var he=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("VCard",{staticClass:"pa-1 ma-1"},[a("VCardTitle",[a("span",[e._v("Свойства изображения")]),a("VSpacer"),a("VBtn",{attrs:{icon:"",color:"red",dark:""},on:{click:function(t){return e.$emit("delete")}}},[a("VIcon",[e._v("mdi-delete-forever")])],1)],1),a("VCardText",[a("VSlider",{attrs:{label:"Непрозрачность",min:"0",max:"1",step:"0.1"},model:{value:e.localOpacity,callback:function(t){e.localOpacity=t},expression:"localOpacity"}}),a("VCheckbox",{attrs:{label:"Тень"},model:{value:e.shadow,callback:function(t){e.shadow=t},expression:"shadow"}}),a("VExpandTransition",[e.shadow?a("VRow",{attrs:{dense:""}},[a("VCol",{attrs:{cols:"4"}},[a("div",{staticClass:"mt-2"},[a("ColorInput",{attrs:{label:"Цвет"},model:{value:e.localShadowColor,callback:function(t){e.localShadowColor=t},expression:"localShadowColor"}})],1)]),a("VCol",{attrs:{cols:"4"}},[a("VTextField",{attrs:{label:"По горизонтали",type:"number",min:"-1000",max:"1000",step:"1"},model:{value:e.localShadowXOffset,callback:function(t){e.localShadowXOffset=e._n(t)},expression:"localShadowXOffset"}})],1),a("VCol",{attrs:{cols:"4"}},[a("VTextField",{attrs:{label:"По вертикали",type:"number",min:"-1000",max:"1000",step:"1"},model:{value:e.localShadowYOffset,callback:function(t){e.localShadowYOffset=e._n(t)},expression:"localShadowYOffset"}})],1),a("VDivider"),a("VSlider",{attrs:{label:"Размытие",min:"0",max:"100",step:"1"},model:{value:e.localShadowBlur,callback:function(t){e.localShadowBlur=t},expression:"localShadowBlur"}})],1):e._e()],1),a("VCheckbox",{attrs:{label:"Обводка"},model:{value:e.stroke,callback:function(t){e.stroke=t},expression:"stroke"}}),a("VExpandTransition",[e.stroke?a("div",[a("ColorInput",{attrs:{label:"Цвет"},model:{value:e.localStrokeColor,callback:function(t){e.localStrokeColor=t},expression:"localStrokeColor"}}),a("VSlider",{attrs:{label:"Толщина",min:"0.5",max:"30",step:"0.5"},model:{value:e.localStrokeWidth,callback:function(t){e.localStrokeWidth=t},expression:"localStrokeWidth"}})],1):e._e()])],1)],1)},me=[],pe={name:"image-layer",mixins:[N,X],components:{ColorInput:W},props:{name:String,image:Image,opacity:Number},data:function(){return{localOpacity:null}},watch:Object(s["a"])({},F(["opacity"]))},ge=pe,ve=Object(g["a"])(ge,he,me,!1,null,null,null),ye=ve.exports;B()(ve,{VBtn:T["a"],VCard:A["a"],VCardText:z["b"],VCardTitle:z["c"],VCheckbox:ae["a"],VCol:ne["a"],VDivider:re["a"],VExpandTransition:ie["a"],VIcon:Z["a"],VRow:U["a"],VSlider:le["a"],VSpacer:se["a"],VTextField:ce["a"]});var be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("VSheet",{staticClass:"pa-1",attrs:{tile:"",color:"blue-grey lighten-2"}},[a("VRow",{attrs:{dense:""}},[a("VCol",{attrs:{cols:"6"}},[a("VCard",[a("FileSelectionArea",{attrs:{"enable-drop-zone":e.enableDropZone},on:{input:function(t){return e.$emit("file-selected",t)}}},[[a("VResponsive",{staticClass:"d-flex align-center justify-center blue-grey lighten-1",attrs:{"aspect-ratio":1}},[a("div",{staticClass:"text-center white--text"},[a("VIcon",{attrs:{size:"48",color:"white"}},[e._v("mdi-plus-thick")]),a("br"),e._v(" Загрузить ")],1)])]],2)],1)],1),e.gallery.length?e._l(e.gallery,(function(t){return a("VCol",{key:t.name,attrs:{cols:"6"}},[a("VCard",{attrs:{dark:""},on:{click:function(a){return e.$emit("url-selected",t.url)}}},[a("VImg",{attrs:{src:t.preview,"aspect-ratio":1,gradient:"to bottom, rgba(0,0,0,.8), transparent 50%"}},[a("VCardActions",[e._v(e._s(t.name))])],1)],1)],1)})):e._e(),e.loadingGallery?a("VCol",{staticClass:"d-flex align-center justify-center",attrs:{cols:"6"}},[a("VProgressCircular",{attrs:{indeterminate:""}})],1):e._e()],2)],1)},we=[],Ce=a("33ae"),ke=a.n(Ce),xe=a("758b"),Ve=a.n(xe),Se=a("befa"),Fe=a("26ab"),_e=a("f3e8"),Oe=a("f767"),$e=a("d789"),Le=[{name:"City",preview:ke.a,url:ke.a},{name:"Field",preview:Ve.a,url:Ve.a},{name:"Forest",preview:Se,url:Se},{name:"Planet",preview:Fe,url:Fe},{name:"Shuttle",preview:_e,url:_e},{name:"Starport",preview:Oe,url:Oe},{name:"Star Trail",preview:$e,url:$e}];function Ie(){return new Promise((function(e){setTimeout((function(){return e(Le)}),1e3)}))}var Be={name:"background-properties",components:{FileSelectionArea:y},props:{enableDropZone:{type:Boolean,default:!1}},data:function(){return{loadingGallery:!1,gallery:[]}},mounted:function(){this.loadGallery()},methods:{loadGallery:function(){var e=this;this.loadingGallery=!0,Ie().then((function(t){return e.gallery=t})).finally((function(){return e.loadingGallery=!1}))}}},Te=Be,Ae=a("adda"),ze=a("490a"),je=a("6b53"),De=Object(g["a"])(Te,be,we,!1,null,null,null),Pe=De.exports;B()(De,{VCard:A["a"],VCardActions:z["a"],VCol:ne["a"],VIcon:Z["a"],VImg:Ae["a"],VProgressCircular:ze["a"],VResponsive:je["a"],VRow:U["a"],VSheet:G["a"]});var Ee=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pa-1"},[a("VRow",{attrs:{dense:""}},[a("VCol",{attrs:{cols:"4"}},[a("VCard",{attrs:{dark:"",elevation:e.elevation(null)},on:{click:function(t){return e.$emit("selected",null)}}},[e.filterPreviewImage?a("VImg",{attrs:{src:e.filterPreviewImage,gradient:"to bottom, rgba(0,0,0,.8), transparent 50%"}},[a("VCardActions",[a("span",{class:e.textClasses(null)},[e._v("None")])])],1):e._e()],1)],1),e._l(e.filters,(function(t,n){return a("VCol",{key:n,attrs:{cols:"4"}},[a("VCard",{attrs:{dark:"",elevation:e.elevation(n)},on:{click:function(t){return e.$emit("selected",n)}}},[a("FilterPreview",{attrs:{image:e.filterPreviewImage,"filter-name":n}},[a("VCardActions",[a("span",{class:e.textClasses(n)},[e._v(e._s(t))])])],1)],1)],1)}))],2)],1)},We=[],Ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.preview?a("VImg",{attrs:{src:e.preview,"aspect-ratio":1,"max-width":"100%",gradient:"to bottom, rgba(0,0,0,.8), transparent 50%"}},[e._t("default")],2):e._e()},Xe=[],Ye={name:"filter-preview",props:{image:[String,null],filterName:String},data:function(){return{preview:null}},watch:{image:{handler:function(e,t){var a=this;e!==t&&(e?this.applyFilter(e).then((function(e){return a.preview=e})):this.preview=null)},immediate:!0}},methods:{applyFilter:function(e){var t=this;return k(e).then((function(e){var a=document.createElement("canvas");return a.width=e.width,a.height=e.height,a.getContext("2d").drawImage(e,0,0),new Promise((function(e){var n=t.filterName;Caman(a,(function(){this[n]().render((function(){return e(a.toDataURL())}))}))}))}))}}},Me=Ye,Re=Object(g["a"])(Me,Ne,Xe,!1,null,null,null),He=Re.exports;B()(Re,{VImg:Ae["a"]});var Ze={name:"filter-properties",components:{FilterPreview:He},props:{filters:Object,selectedFilter:[String,null],filterPreviewImage:[String,null]},computed:{elevation:function(){var e=this;return function(t){return t===e.selectedFilter?3:0}},textClasses:function(){var e=this;return function(t){return t===e.selectedFilter?"font-weight-bold yellow--text":"white--text"}}}},Ue=Ze,Ge=Object(g["a"])(Ue,Ee,We,!1,null,null,null),qe=Ge.exports;B()(Ge,{VCard:A["a"],VCardActions:z["a"],VCol:ne["a"],VImg:Ae["a"],VRow:U["a"]});var Je={name:"input-panel",props:{layers:Array,fontFamilyNames:Array,filter:[String,null],filters:Object,selectedLayer:[Object,null],filterPreviewImage:[String,null],disableFilterTab:Boolean},data:function(){return{localLayers:[],tabs:0}},components:{FileSelectionArea:y,TextLayer:fe,ImageLayer:ye,BackgroundProperties:Pe,FilterProperties:qe},watch:{layers:{handler:function(e){Object(C["isEqual"])(e,this.localLayers)||(this.localLayers=e.slice())},deep:!0,immediate:!0},localLayers:{handler:function(e){Object(C["isEqual"])(e,this.layers)||this.$emit("update:layers",e.slice())},deep:!0,immediate:!0},tabs:function(e,t){e!==t&&(2===e?this.$emit("enter-filters"):2===t&&this.$emit("leave-filters"))}},methods:{removeLayer:function(e){this.$emit("remove-layer",e)}}},Ke=Je,Qe=(a("98ee"),a("71a3")),et=a("c671"),tt=a("fe57"),at=a("aac8"),nt=Object(g["a"])(Ke,c,u,!1,null,"2985ee5b",null),rt=nt.exports;B()(nt,{VCard:A["a"],VCol:ne["a"],VExpandTransition:ie["a"],VIcon:Z["a"],VResponsive:je["a"],VRow:U["a"],VTab:Qe["a"],VTabItem:et["a"],VTabs:tt["a"],VTabsItems:at["a"]});var it=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"working-area d-flex flex-column blue-grey lighten-5"},[a("VToolbar",{staticClass:"flex-grow-0",attrs:{color:"blue-grey",flat:""}},[e.selectedFormat?[a("VToolbarTitle",{staticClass:"white--text"},[e._v(" "+e._s(e.selectedFormat.title)+" ("+e._s(e.selectedFormat.size[0])+"x"+e._s(e.selectedFormat.size[1])+") ")]),a("VSpacer"),a("VTooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("VBtn",e._g({on:{click:e.unselectFormat}},n),[a("VIcon",[e._v("mdi-view-list")])],1)]}}],null,!1,3161455761)},[e._v(" Вернуться к списку ")])]:[e.disableFormatsToggling?e._e():a("VMenu",{attrs:{"close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("VTooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[a("VBtn",e._g({attrs:{dark:"",icon:""},on:{click:e.unselectFormat}},Object.assign({},n,r)),[a("VIcon",[e._v("mdi-format-list-checks")])],1)]}}],null,!0)},[e._v(" Добавить / Удалить размеры ")])]}}],null,!1,4171466210),model:{value:e.displayFormatsMenu,callback:function(t){e.displayFormatsMenu=t},expression:"displayFormatsMenu"}},[a("VCard",[a("VCardText",e._l(e.formats,(function(t){return a("VCheckbox",{key:t.title,attrs:{label:e.formatTitle(t),disabled:t.selected&&e.selectedFormats.length<2},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"format.selected"}})})),1),a("VCardActions",[a("VBtn",{on:{click:function(t){e.displayFormatsMenu=!1}}},[e._v(" Ok ")])],1)],1)],1),a("VSpacer"),a("VBtn",{attrs:{color:"green",dark:""},on:{click:e.onSaveAll}},[a("VIcon",[e._v("mdi-content-save")]),e._v(" Сохранить все ")],1)]],2),a("div",{staticClass:"working-area__viewport flex-grow-1 flex-shrink-1 align-start"},[a("VFadeTransition",[e.selectedFormat?a("FabricCanvasScaler",{key:"editor-canvas",staticClass:"fill-height",attrs:{width:e.selectedFormat.size[0],height:e.selectedFormat.size[1]}},[e._l(e.layers,(function(t,n){return["image"===t.type?a("VFabricImage",{key:t.id,attrs:{image:t.image,opacity:t.opacity,"shadow-color":t.shadowColor,"shadow-x-offset":t.shadowXOffset,"shadow-y-offset":t.shadowYOffset,"shadow-blur":t.shadowBlur,stroke:t.stroke,"stroke-width":t.strokeWidth,top:e.layersAugments[e.selectedFormat.title][t.id].top,left:e.layersAugments[e.selectedFormat.title][t.id].left,"scale-x":e.layersAugments[e.selectedFormat.title][t.id].scaleX,"scale-y":e.layersAugments[e.selectedFormat.title][t.id].scaleY,angle:e.layersAugments[e.selectedFormat.title][t.id].angle},on:{"update:top":function(a){return e.$set(e.layersAugments[e.selectedFormat.title][t.id],"top",a)},"update:left":function(a){return e.$set(e.layersAugments[e.selectedFormat.title][t.id],"left",a)},"update:scaleX":function(a){return e.$set(e.layersAugments[e.selectedFormat.title][t.id],"scaleX",a)},"update:scale-x":function(a){return e.$set(e.layersAugments[e.selectedFormat.title][t.id],"scaleX",a)},"update:scaleY":function(a){return e.$set(e.layersAugments[e.selectedFormat.title][t.id],"scaleY",a)},"update:scale-y":function(a){return e.$set(e.layersAugments[e.selectedFormat.title][t.id],"scaleY",a)},"update:angle":function(a){return e.$set(e.layersAugments[e.selectedFormat.title][t.id],"angle",a)},selected:function(a){return e.onLayerSelected(t)},deselected:function(a){return e.onLayerDeselected(t)}}}):"text"===t.type?a("VFabricText",{key:t.id,attrs:{text:t.text,"font-size":t.fontSize,fill:t.color,"char-spacing":t.charSpacing,"font-family":t.fontFamily,"font-weight":t.fontWeight,underline:t.underline,linethrough:t.linethrough,overline:t.overline,"font-style":t.fontStyle,"text-align":t.textAlign,"shadow-color":t.shadowColor,"shadow-x-offset":t.shadowXOffset,"shadow-y-offset":t.shadowYOffset,"shadow-blur":t.shadowBlur,stroke:t.stroke,"stroke-width":t.strokeWidth,"line-height":t.lineHeight,"text-background-color":t.textBackgroundColor,opacity:t.opacity,top:e.layersAugments[e.selectedFormat.title][t.id].top,left:e.layersAugments[e.selectedFormat.title][t.id].left,"scale-x":e.layersAugments[e.selectedFormat.title][t.id].scaleX,"scale-y":e.layersAugments[e.selectedFormat.title][t.id].scaleY,angle:e.layersAugments[e.selectedFormat.title][t.id].angle},on:{"update:top":function(a){return e.$set(e.layersAugments[e.selectedFormat.title][t.id],"top",a)},"update:left":function(a){return e.$set(e.layersAugments[e.selectedFormat.title][t.id],"left",a)},"update:scaleX":function(a){return e.$set(e.layersAugments[e.selectedFormat.title][t.id],"scaleX",a)},"update:scale-x":function(a){return e.$set(e.layersAugments[e.selectedFormat.title][t.id],"scaleX",a)},"update:scaleY":function(a){return e.$set(e.layersAugments[e.selectedFormat.title][t.id],"scaleY",a)},"update:scale-y":function(a){return e.$set(e.layersAugments[e.selectedFormat.title][t.id],"scaleY",a)},"update:angle":function(a){return e.$set(e.layersAugments[e.selectedFormat.title][t.id],"angle",a)},selected:function(a){return e.onLayerSelected(t)},deselected:function(a){return e.onLayerDeselected(t)}}}):e._e()]})),e.backgroundImage?a("VFabricBackgroundImage",{attrs:{image:e.backgroundImage}}):e._e()],2):a("VFadeTransition",{key:"previews-list",staticClass:"row fill-height row--dense px-1",attrs:{tag:"div",group:"","leave-absolute":""}},e._l(e.selectedFormats,(function(t,n){return a("VCol",{key:t.title,staticClass:"working-area__preview-col",class:e.formatPreviewClass,attrs:{cols:e.formatPreviewCols,offset:e.formatPreviewOffset(n)}},[a("VCard",{staticClass:"working-area__preview-card fill-height d-flex flex-column justify-start pa-1",attrs:{color:"blue-grey lighten-2"}},[e.isFilterMode?a("CamanCanvasScaler",{ref:"filterPreview",refInFor:!0,attrs:{width:t.size[0],height:t.size[1],image:e.filterSourceImages[t.title],filter:e.filter},on:{applying:function(t){return e.$emit("filter-applying")},applied:function(t){return e.$emit("filter-applied")}}}):a("FabricCanvasScaler",{ref:"preview",refInFor:!0,staticClass:"working-area__preview-canvas-container flex-grow-1",attrs:{"static-canvas":"",width:t.size[0],height:t.size[1]},nativeOn:{click:function(a){return e.selectFormat(t)}}},[e._l(e.layers,(function(n,r){return["image"===n.type?a("VFabricImage",{key:n.id,attrs:{image:n.image,opacity:n.opacity,"shadow-color":n.shadowColor,"shadow-x-offset":n.shadowXOffset,"shadow-y-offset":n.shadowYOffset,"shadow-blur":n.shadowBlur,stroke:n.stroke,"stroke-width":n.strokeWidth,top:e.layersAugments[t.title][n.id].top,left:e.layersAugments[t.title][n.id].left,"scale-x":e.layersAugments[t.title][n.id].scaleX,"scale-y":e.layersAugments[t.title][n.id].scaleY,angle:e.layersAugments[t.title][n.id].angle}}):"text"===n.type?a("VFabricText",{key:n.id,attrs:{text:n.text,"font-size":n.fontSize,fill:n.color,"char-spacing":n.charSpacing,"font-family":n.fontFamily,"font-weight":n.fontWeight,underline:n.underline,linethrough:n.linethrough,overline:n.overline,"font-style":n.fontStyle,"text-align":n.textAlign,"shadow-color":n.shadowColor,"shadow-x-offset":n.shadowXOffset,"shadow-y-offset":n.shadowYOffset,"shadow-blur":n.shadowBlur,stroke:n.stroke,"stroke-width":n.strokeWidth,"line-height":n.lineHeight,"text-background-color":n.textBackgroundColor,opacity:n.opacity,top:e.layersAugments[t.title][n.id].top,left:e.layersAugments[t.title][n.id].left,"scale-x":e.layersAugments[t.title][n.id].scaleX,"scale-y":e.layersAugments[t.title][n.id].scaleY,angle:e.layersAugments[t.title][n.id].angle}}):e._e()]})),e.backgroundImage?a("VFabricBackgroundImage",{attrs:{image:e.backgroundImage}}):e._e()],2),a("VCardActions",{staticClass:"flex-grow-0"},[a("VSpacer"),a("VSheet",{staticClass:"px-2",attrs:{color:"yellow"}},[e._v(" "+e._s(t.title)+" ("+e._s(t.size[0])+"x"+e._s(t.size[1])+") ")])],1)],1)],1)})),1)],1)],1)],1)},ot=[],lt=(a("3ca3"),a("ddb0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fabric-canvas-scaler"},[e.canvasScale&&e.staticCanvas?a("VFabricStaticCanvas",{ref:"canvas",staticClass:"fabric-canvas-scaler__canvas d-flex align-center align-self-center justify-center",staticStyle:{position:"absolute"},attrs:{width:e.canvasWidth,height:e.canvasHeight,zoom:e.canvasScale}},[e._t("default")],2):e.canvasScale?a("VFabricCanvas",{ref:"canvas",staticClass:"fabric-canvas-scaler__canvas d-flex align-center align-self-center justify-center",staticStyle:{position:"absolute"},attrs:{width:e.canvasWidth,height:e.canvasHeight,zoom:e.canvasScale}},[e._t("default")],2):e._e()],1)}),st=[],ct=a("7a94"),ut=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"v-fabric"},[a("canvas",{ref:"canvas",staticClass:"v-fabric__canvas",attrs:{width:e.width,height:e.height}}),a("div",{staticStyle:{display:"none"}},[e._t("default")],2)])},dt=[];function ft(){var e={};return e.promise=new Promise((function(t){e.resolve=t})),e}function ht(e){var t="local"+Object(C["upperFirst"])(e),a="set"+Object(C["upperFirst"])(e);return function(e){e!==this[t]&&(this[t]=e,this.deferred.promise.then((function(t){t[a](e),t.calcOffset()})))}}var mt,pt,gt={props:{width:{type:[Number,String],default:300},height:{type:[Number,String],default:150},zoom:Number},data:function(){return{fabricCanvas:null,localWidth:null,localHeight:null,deferred:ft()}},provide:function(){var e=this;return{promiseFabricCanvas:function(){return e.deferred.promise}}},mounted:function(){this.fabricCanvas=this.buildCanvasObject(),this.deferred.resolve(this.fabricCanvas)},beforeDestroy:function(){return this.deferred.promise.then((function(e){return e.dispose()}))},watch:{width:{handler:ht("width"),immediate:!0},height:{handler:ht("height"),immediate:!0},zoom:function(e){e&&this.deferred.promise.then((function(t){return t.setZoom(e)}))}},methods:{buildCanvasObject:function(){},buildCanvasOptions:function(){var e={};return e},toDataUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},{multiplier:1},e);return this.zoom&&(t.multiplier/=this.zoom),this.deferred.promise.then((function(e){return e.toDataURL(t)}))}}},vt={name:"v-fabric-static-canvas",mixins:[gt],methods:{buildCanvasObject:function(){var e=new ct["fabric"].StaticCanvas(this.$refs.canvas,this.buildCanvasOptions());return this.zoom&&e.setZoom(this.zoom),e}}},yt=vt,bt=Object(g["a"])(yt,ut,dt,!1,null,null,null),wt=bt.exports,Ct={name:"v-fabric-canvas",extends:wt,methods:{buildCanvasObject:function(){var e=new ct["fabric"].Canvas(this.$refs.canvas,this.buildCanvasOptions());return this.zoom&&e.setZoom(this.zoom),e.selection=!1,e}}},kt=Ct,xt=Object(g["a"])(kt,mt,pt,!1,null,null,null),Vt=xt.exports,St={name:"fabric-canvas-scaler",components:{VFabricCanvas:Vt,VFabricStaticCanvas:wt},props:{width:{type:Number,default:300},height:{type:Number,default:150},staticCanvas:{type:Boolean,default:!1}},data:function(){return{canvasWidth:this.width,canvasHeight:this.height,canvasScale:0}},mounted:function(){var e=this;this.debouncedScaleToFit=Object(C["debounce"])((function(){return e.scaleToFit()}),300),this.scaleToFit(),this.resizeHandler=function(t){return e.debouncedScaleToFit()},window.addEventListener("resize",this.resizeHandler)},beforeDestroy:function(){window.removeEventListener("resize",this.resizeHandler)},methods:{scaleToFit:function(){this.canvasScale=0;var e=this.$el.getBoundingClientRect(),t=e.width,a=e.height,n=this.width,r=this.height,i=n/r;n>t&&(n=t,r=n/i),r>a&&(r=a,n=r*i),this.canvasWidth=n,this.canvasHeight=r,this.canvasScale=n/this.width},toDataUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.$refs.canvas.toDataUrl(e)}}},Ft=St,_t=(a("1f4e"),Object(g["a"])(Ft,lt,st,!1,null,"79ecf258",null)),Ot=_t.exports;function $t(e){return function(t,a){var n=this;t!==a&&t!==this.instance.get(e)&&this.promiseFabricCanvas().then((function(a){n.instance.set(e,t),a.renderAll()}))}}function Lt(e){var t={};return Object.keys(e).forEach((function(a){var n=e[a];t[a]={type:n.type},"default"in n&&(t[a].default=n.default)})),t}function It(e){var t={};return Object.keys(e).forEach((function(a){var n=e[a];if(n.watchable){var r="string"===typeof n.option?n.option:a;t[a]={handler:$t(r)}}})),t}var Bt=["added","removed","deselected","moved","sca","rotated","skewed","rotating","scaling","skewing","mousedown","mouseup","mouseover","mouseout","mousewheel","mousedblclick","dragover","dragenter","dragleave","drop"],Tt={top:{type:Number,default:0,option:!0,initialize:!0,watchable:!0,updatable:!0},left:{type:Number,default:0,option:!0,initialize:!0,watchable:!0,updatable:!0},scaleX:{type:Number,default:1,option:!0,initialize:!0,watchable:!0,updatable:!0},scaleY:{type:Number,default:1,option:!0,initialize:!0,watchable:!0,updatable:!0},angle:{type:Number,default:0,option:!0,initialize:!0,watchable:!0,updatable:!0},skewX:{type:Number,default:0,option:!0,initialize:!0,watchable:!0,updatable:!0},skewY:{type:Number,default:0,option:!0,initialize:!0,watchable:!0,updatable:!0},opacity:{type:Number,default:1,option:!0,initialize:!0,watchable:!0}};function At(e){var t=Object(C["union"])(Bt,e.events||[]),a=Object.assign({},Tt,e.props||{});return{inject:["promiseFabricCanvas"],props:Lt(a),data:function(){return{instance:null}},mounted:function(){var e=this;return this.instance=this.buildInstance(),this.promiseFabricCanvas().then((function(t){return t.add(e.instance)}))},watch:It(a),beforeDestroy:function(){return this.onBeforeDestroy()},methods:{onBeforeDestroy:function(){var e=this;return this.instance?this.promiseFabricCanvas().then((function(t){t.remove(e.instance),e.instance.off()})):this.$nextTick((function(){return e.onBeforeDestroy()}))},buildInstance:function(){var e=new ct["fabric"][this.fabricConstructorName](this.getFabricConstructorFirstArgument(),this.buildOptions());return this.bindEvents(e),e},getFabricConstructorFirstArgument:function(){},buildOptions:function(){var e=this,t={};return Object.keys(a).forEach((function(n){var r=a[n];if("option"in r&&r.initialize){var i="string"===typeof r.option?r.option:n;t[i]=e[n]}})),this.extendOptions(t)},extendOptions:function(e){return e},bindEvents:function(e){var n=this;t.forEach((function(t){e.on(t,(function(e){n.$emit(t,e)}))})),e.on("selected",(function(e){n.$emit("selected",e),n.promiseFabricCanvas().then((function(e){e.bringToFront(n.instance)}))})),e.on("modified",(function(e){n.$emit("modified",e),Object.keys(a).forEach((function(e){var t=a[e];if(t.updatable){var r="string"===typeof t.option?t.option:e,i=n.instance.get(r);n[e]!==i&&n.$emit("update:"+Object(C["kebabCase"])(e),i)}}))})),this.extendEvents(e)},extendEvents:function(e){}},render:function(e){return this.$slots.default?e("div",this.$slots.default):null}}}var zt=At,jt={props:{shadowColor:{type:[String,null],default:null},shadowXOffset:{type:Number,default:0},shadowYOffset:{type:Number,default:0},shadowBlur:{type:Number,default:0}},computed:{shadow:function(){return this.shadowColor?{color:this.shadowColor,blur:this.shadowBlur,offsetX:this.shadowXOffset,offsetY:this.shadowYOffset}:null}},watch:{shadow:{handler:function(e){var t=this;this.promiseFabricCanvas().then((function(a){t.instance&&(t.instance.setShadow(e),a.renderAll())}))},immediate:!0}}},Dt={stroke:{type:String,default:"#000",option:!0,initialize:!0,watchable:!0},strokeWidth:{type:Number,default:0,option:!0,initialize:!0,watchable:!0}},Pt=zt({props:Object(s["a"])({},Dt)}),Et={name:"v-fabric-image",mixins:[Pt,jt],props:{image:Image},data:function(){return{fabricConstructorName:"Image"}},methods:{getFabricConstructorFirstArgument:function(){return this.image}}},Wt=zt({props:Object(s["a"])({},Dt,{fontSize:{type:Number,default:70,option:!0,initialize:!0,watchable:!0},fill:{type:String,default:"#000",option:!0,initialize:!0,watchable:!0},charSpacing:{type:Number,default:0,option:!0,initialize:!0,watchable:!0},fontFamily:{type:String,default:"sans-serif",option:!0,initialize:!0,watchable:!0},fontWeight:{type:String,default:"normal",option:!0,initialize:!0,watchable:!0},underline:{type:Boolean,default:!1,option:!0,initialize:!0,watchable:!0},linethrough:{type:Boolean,default:!1,option:!0,initialize:!0,watchable:!0},overline:{type:Boolean,default:!1,option:!0,initialize:!0,watchable:!0},fontStyle:{type:String,default:"normal",option:!0,initialize:!0,watchable:!0},textAlign:{type:String,default:"left",option:!0,initialize:!0,watchable:!0},lineHeight:{type:Number,default:1,option:!0,initialize:!0,watchable:!0},textBackgroundColor:{type:[String,null],default:null,option:!0,initialize:!0,watchable:!0}})}),Nt={name:"v-fabric-text",mixins:[Wt,jt],props:{text:{type:String,default:""}},data:function(){return{fabricConstructorName:"Text"}},computed:{shadow:function(){if(this.shadowColor)return"".concat(this.shadowColor," ").concat(this.shadowXOffset,"px ").concat(this.shadowYOffset,"px ").concat(this.shadowBlur,"px")}},watch:{text:function(e){var t=this;this.promiseFabricCanvas().then((function(a){t.instance&&e!==t.instance.get("text")&&(t.instance.set("text",e),a.renderAll())}))}},methods:{getFabricConstructorFirstArgument:function(){return this.text}}},Xt={name:"v-fabric-background-image",inject:["promiseFabricCanvas"],props:{image:Image},render:function(e){return this.$slots.default?e("div",this.$slots.default):null},mounted:function(){this.setBackgroundImage()},beforeDestroy:function(){this.clearBackgroundImage()},watch:{image:function(e){e?this.setBackgroundImage(e):this.clearBackgroundImage()}},methods:{setBackgroundImage:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.image;return this.promiseFabricCanvas().then((function(a){a.setBackgroundImage(t.src,(function(){return a.renderAll()}),e.calculatePosition(a,t))}))},clearBackgroundImage:function(){return this.promiseFabricCanvas().then((function(e){e.setBackgroundImage(!1,(function(){e.lowerCanvasEl&&e.renderAll()}))}))},calculatePosition:function(e,t){var a,n,r,i=e.getZoom(),o=e.getWidth()/i,l=e.getHeight()/i,s=o/l,c=t.width/t.height;return s>=c?(a=o/t.width,r=0,n=-(t.height*a-l)/2):(a=l/t.height,n=0,r=-(t.width*a-o)/2),{top:n,left:r,scaleX:a,scaleY:a,originX:"left",originY:"top"}}}},Yt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"caman-canvas-scaler"},[e.canvasScale?a("CamanCanvas",{ref:"canvas",staticClass:"caman-canvas-scaler__canvas",style:e.canvasStyle,attrs:{width:e.width,height:e.height,image:e.image,filter:e.filter},on:{applying:function(t){return e.$emit("applying")},applied:function(t){return e.$emit("applied")}}}):e._e()],1)},Mt=[],Rt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("canvas",{ref:"canvas",attrs:{width:e.width,height:e.height}})},Ht=[];function Zt(){var e={};return e.promise=new Promise((function(t){e.resolve=t})),e}var Ut={name:"caman-canvas",props:{width:{type:Number,default:300},height:{type:Number,default:150},scale:{type:Number,default:1},image:String,filter:[String,null]},data:function(){return{deferred:Zt(),initialised:!1}},computed:{canvasStyle:function(){return{transform:"scale(".concat(this.scale,", ").concat(this.scale,")")}}},watch:{image:{handler:function(e,t){var a=this;e!==t&&e&&this.setImageToCanvas(e).then((function(){return a.initialised?a.reloadCanvasData():a.initCaman()}))},immediate:!0},filter:function(e,t){var a=this;if(e!==t)return e?t?this.revertFilter().then((function(){return a.applyFilter(e)})):this.applyFilter(e):this.revertFilter(!0)}},mounted:function(){},methods:{setImageToCanvas:function(e){var t=this;return k(e).then((function(e){t.$refs.canvas.getContext("2d").drawImage(e,0,0)}))},reloadCanvasData:function(){return this.deferred.promise.then((function(e){return e.reloadCanvasData()}))},initCaman:function(){this.initialised=!0;var e=this;Caman(this.$refs.canvas,(function(){e.deferred.resolve(this)}))},applyFilter:function(e){var t=this;return this.$emit("applying"),this.deferred.promise.then((function(a){return new Promise((function(n){a[e]().render((function(){t.$emit("applied"),n(a)}))}))}))},revertFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.deferred.promise.then((function(t){return t.revert(e),t}))},toDataUrl:function(){return this.$refs.canvas.toDataURL()}}},Gt=Ut,qt=Object(g["a"])(Gt,Rt,Ht,!1,null,null,null),Jt=qt.exports,Kt={name:"fabric-canvas-scaler",components:{CamanCanvas:Jt},props:{width:{type:Number,default:300},height:{type:Number,default:150},image:String,filter:[String,null]},data:function(){return{canvasScale:0,offsetTop:0,offsetLeft:0}},computed:{canvasStyle:function(){return{transform:"matrix(".concat(this.canvasScale,", 0, 0, ").concat(this.canvasScale,", ").concat(this.offsetLeft,", ").concat(this.offsetTop,")")}}},mounted:function(){var e=this;this.debouncedScaleToFit=Object(C["debounce"])((function(){return e.scaleToFit()}),300),this.scaleToFit(),this.resizeHandler=function(t){return e.debouncedScaleToFit()},window.addEventListener("resize",this.resizeHandler)},beforeDestroy:function(){window.removeEventListener("resize",this.resizeHandler)},methods:{scaleToFit:function(){this.canvasScale=0;var e=this.$el.getBoundingClientRect(),t=e.width,a=e.height,n=(e.top,e.left,this.width),r=this.height,i=n/r;n>t&&(n=t,r=n/i),r>a&&(r=a,n=r*i),this.canvasScale=n/this.width,this.offsetTop=a/2-r/2,this.offsetLeft=t/2-n/2},toDataUrl:function(){return this.$refs.canvas.toDataUrl()}}},Qt=Kt,ea=(a("46a5"),Object(g["a"])(Qt,Yt,Mt,!1,null,"7531f0b4",null)),ta=ea.exports,aa={name:"working-area",components:{FabricCanvasScaler:Ot,VFabricImage:Et,VFabricText:Nt,VFabricBackgroundImage:Xt,CamanCanvasScaler:ta},props:{layers:Array,formats:Array,backgroundImage:{type:[Image,null],default:null},filter:[String,null],selectedFormat:[Object,null],disableFormatsToggling:{type:Boolean,defaulT:!1},isFilterMode:Boolean,filterSourceImages:[Object,null]},data:function(){return{layersAugments:{},displayFormatsMenu:!1}},computed:{selectedFormats:function(){return this.formats.filter((function(e){return e.selected}))},formatTitle:function(){return function(e){return"".concat(e.title," (").concat(e.size[0],"x").concat(e.size[1],")")}},formatPreviewCols:function(){switch(this.selectedFormats.length){case 6:case 5:case 3:default:return 4;case 4:case 2:return 6;case 1:return 12}},formatPreviewOffset:function(){var e=this;return function(t){var a=e.selectedFormats.length;return 5===a&&3===t?2:0}},formatPreviewClass:function(){return this.selectedFormats.length>3?"h50p":"fill-height"}},mounted:function(){this.fillLayersAugments(this.formats,this.layers)},watch:{formats:function(e){this.fillLayersAugments(e,this.layers)},layers:function(e){this.fillLayersAugments(this.formats,e)},selectedFormats:function(){var e=this;this.$nextTick((function(){e.$refs.preview.forEach((function(e){e.scaleToFit()}))}))},isFilterMode:function(e){var t=this;if(e)return this.$emit("fabric-images-saving"),this.saveFabricImages().then((function(e){return t.$emit("fabric-images-saved",e)})).catch((function(e){throw t.$emit("fabric-images-saving-error",e),e}))}},methods:{selectFormat:function(e){this.$emit("format-selected",e)},unselectFormat:function(){this.$emit("format-deselected")},fillLayersAugments:function(e,t){var a=this;e.forEach((function(e){var n=e.title,r=[],i=[];n in a.layersAugments&&(r=a.layersAugments[n]),t.forEach((function(e){var t=e.id;r[t]?i[t]=r[t]:i[t]={top:0,left:0,scaleX:1,scaleY:1,angle:0}})),a.$set(a.layersAugments,n,i)}))},onLayerSelected:function(e){this.$emit("layer-selected",e)},onLayerDeselected:function(e){this.$emit("layer-deselected",e)},saveFabricImages:function(){var e=this;return new Promise((function(t){var a={},n=[];return e.$refs.preview.forEach((function(t,r){var i=e.selectedFormats[r].title;n.push(t.toDataUrl().then((function(e){return a[i]=e})))})),Promise.all(n).then((function(){return t(a)}))}))},saveFilteredImages:function(){var e=this,t={};return this.$refs.filterPreview.forEach((function(a,n){var r=e.selectedFormats[n].title;t[r]=a.toDataUrl()})),Promise.resolve(t)},onSaveAll:function(){var e,t=this;return this.$emit("saving-all"),e=this.isFilterMode?this.saveFilteredImages():this.saveFabricImages(),e.then((function(e){return t.$emit("saved-all",e),e})).catch((function(e){throw t.$emit("error-saving-all",e),e}))}}},na=aa,ra=(a("e86a"),a("71d9")),ia=a("2a7f"),oa=Object(g["a"])(na,it,ot,!1,null,"452bc666",null),la=oa.exports;B()(oa,{VBtn:T["a"],VCard:A["a"],VCardActions:z["a"],VCardText:z["b"],VCheckbox:ae["a"],VCol:ne["a"],VFadeTransition:ie["c"],VIcon:Z["a"],VMenu:P["a"],VSheet:G["a"],VSpacer:se["a"],VToolbar:ra["a"],VToolbarTitle:ia["a"],VTooltip:q["a"]});var sa=a("27d6"),ca={name:"media-editor",components:{InputPanel:rt,WorkingArea:la},props:{fontFamilies:{type:Array,default:function(){return["Open Sans","Oswald"]}}},data:function(){return{loading:!1,loadProgress:null,isSavingAll:!1,layers:[],backgroundImage:null,layerId:0,formats:[{title:"Instagram",size:[1080,1080],selected:!0},{title:"Instagram Story",size:[1080,1920],selected:!0},{title:"Facebook",size:[1200,630],selected:!0},{title:"Twitter",size:[1024,512],selected:!0},{title:"LinkedIn",size:[1200,627],selected:!0},{title:"Pinterest",size:[1e3,1500],selected:!0}],filters:{vintage:"Vintage",lomo:"Lomo",clarity:"Clarity",sinCity:"Sin City",sunrise:"Sunrise",crossProcess:"Cross Process",orangePeel:"Orange Peel",love:"Love",grungy:"Grungy",jarques:"Jarques",pinhole:"Pinhole",oldBoot:"Old Boot",glowingSun:"Glowing Sun",hazyDays:"Hazy Days",herMajesty:"Her Majesty",nostalgia:"Nostalgia",hemingway:"Hemingway",concentrate:"Concentrate"},selectedFilter:null,selectedLayer:null,selectedFormat:null,filterPreviewImage:null,disableFormatSelection:!1,applyingFiltersCounter:0,savedImages:{},savedResultImages:{},isFilterMode:!1}},computed:{renderLayers:function(){return this.layers.filter((function(e){return!("text"===e.type&&!e.text)}))},disableFiltersTab:function(){return!this.backgroundImage&&!this.renderLayers.length||!!this.selectedFormat},showLoading:function(){return this.loading||!!this.applyingFiltersCounter||this.isSavingAll},loadProgressPercentage:function(){return null===this.loadProgress?null:(100*this.loadProgress).toFixed()+"%"},fontFamilyNames:function(){return this.fontFamilies.map((function(e){return e.split(":")[0]}))}},created:function(){sa.load({google:{families:this.fontFamilies}})},mounted:function(){},watch:{selectedLayer:function(e,t){e!==t&&t&&"text"===t.type&&!t.text&&this.removeLayer(t)}},methods:{onBackgroundImageUrlSelected:function(e){var t=this;this.preloadImage(e).then((function(e){return t.backgroundImage=e}))},onBackgroundImageFileSelected:function(e){var t=this;e&&this.preloadImageFile(e[0]).then((function(e){return t.backgroundImage=e}))},onFileSelected:function(e){var t=this;if(e)return this.preloadImageFile(e[0]).then((function(e){return t.addImageLayer(e)}))},makeLayerId:function(){return++this.layerId},makeLayerBase:function(e){return{id:this.makeLayerId(),name:e,opacity:1,shadowColor:null,shadowXOffset:0,shadowYOffset:0,shadowBlur:0,stroke:"#000",strokeWidth:0}},addTextLayer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Текст";this.addLayer(Object(s["a"])({},this.makeLayerBase(t),{type:"text",text:e,fontSize:30,color:"#000",charSpacing:0,fontFamily:"sans-serif",fontWeight:"normal",underline:!1,linethrough:!1,overline:!1,fontStyle:"normal",textAlign:"left",strokeWidth:0,lineHeight:1,textBackgroundColor:null}))},addImageLayer:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Изображение";this.addLayer(Object(s["a"])({},this.makeLayerBase(t),{type:"image",image:e}))},addLayer:function(e){this.layers.push(e),this.selectedLayer=e},loadImageFile:function(e){var t=this;return this.loading=!0,this.loadProgress=0,x(e,(function(e){t.loadProgress=e})).finally((function(){t.loading=!1,t.loadProgress=null}))},preloadImage:function(e){var t=this;return this.loading=!0,k(e).finally((function(){return t.loading=!1}))},preloadImageFile:function(e){var t=this;return this.loadImageFile(e).then((function(e){return t.preloadImage(e)}))},removeLayer:function(e){e===this.selectedLayer&&(this.selectedLayer=null),this.layers.splice(this.layers.indexOf(e),1)},onLayerSelected:function(e){this.selectedLayer=e;var t=this.layers.indexOf(e);t!==this.layers.length-1&&(this.layers.splice(t,1),this.layers.push(e))},onLayerDeselected:function(e){this.selectedLayer=null},onFormatSelected:function(e){this.disableFormatSelection||(this.selectedFormat=e)},onFormatDeselected:function(){this.selectedFormat=null},onEnterFilters:function(){this.disableFormatSelection=!0,this.isFilterMode=!0,this.selectedFormat=null,this.selectedLayer=null},onLeaveFilters:function(){this.disableFormatSelection=!1,this.isFilterMode=!1,this.selectedFilter=null},onApplyingFilter:function(){this.applyingFiltersCounter++},onAppliedFilter:function(){this.applyingFiltersCounter--},onSavingAll:function(){this.isSavingAll=!0},onSavedAll:function(e){this.isSavingAll=!1,this.savedResultImages=e;var t=window.open();Object.keys(e).forEach((function(a){var n=e[a];t.document.write('<img src="'.concat(n,'">'))})),t.document.close()},onErrorSavingAll:function(e){this.isSavingAll=!1},onFabricImagesSaving:function(){this.loading=!0},onFabricImagesSaved:function(e){var t=this;this.loading=!1,this.savedImages=e,this.resizeForFilterPreview(e[Object.keys(e)[0]],300,300).then((function(e){return t.filterPreviewImage=e}))},onFabricImagesSavingError:function(e){this.loading=!1},resizeForFilterPreview:function(e,t,a){return k(e).then((function(e){var n=e.width,r=e.height,i=n/r;n>t&&(n=t,r=n/i),r>a&&(r=a,n=r*i);var o=document.createElement("canvas");return o.width=n,o.height=r,o.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,n,r),o.toDataURL()}))}}},ua=ca,da=a("a523"),fa=a("a797"),ha=Object(g["a"])(ua,o,l,!1,null,null,null),ma=ha.exports;B()(ha,{VCol:ne["a"],VContainer:da["a"],VOverlay:fa["a"],VProgressCircular:ze["a"],VRow:U["a"]});var pa={name:"App",components:{MediaEditor:ma},data:function(){return{}}},ga=pa,va=a("7496"),ya=a("a75b"),ba=Object(g["a"])(ga,r,i,!1,null,null,null),wa=ba.exports;B()(ba,{VApp:va["a"],VContent:ya["a"]});var Ca=a("f309"),ka=a("2992"),xa=a.n(ka);n["a"].use(Ca["a"]);var Va=new Ca["a"]({lang:{locales:{ru:xa.a},current:"ru"}});a("a65a"),console.log(window.Caman),new n["a"]({vuetify:Va,render:function(e){return e(wa)}}).$mount("#app")},"70c1":function(e,t,a){},"758b":function(e,t,a){e.exports=a.p+"img/field.66dd509b.jpg"},8013:function(e,t,a){},"98ee":function(e,t,a){"use strict";var n=a("10ea"),r=a.n(n);r.a},a632:function(e,t,a){},befa:function(e,t,a){e.exports=a.p+"img/forest.27de3f7d.jpg"},c99c:function(e,t,a){"use strict";var n=a("70c1"),r=a.n(n);r.a},d3d3:function(e,t,a){},d789:function(e,t,a){e.exports=a.p+"img/startrail.a17c5d19.jpg"},e86a:function(e,t,a){"use strict";var n=a("d3d3"),r=a.n(n);r.a},f3e8:function(e,t,a){e.exports=a.p+"img/shuttle.c6cb4d8c.jpg"},f767:function(e,t,a){e.exports=a.p+"img/starport.73d0b3ad.jpg"}});
//# sourceMappingURL=app.5a5e7465.js.map